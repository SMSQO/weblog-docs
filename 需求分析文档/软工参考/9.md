# **一、引言**

## 1.1定位与目标

为满足同学们的娱乐需求，实现便捷地在线上进行德州扑克等联机桌游，我们决定开发一个简易的联机桌游网站**MiniFun**，作为软件工程的课程项目。我们的计划是只设计德州扑克一个游戏，但保留拓展游戏数量的接口，并做到游戏过程方便快捷。本文档目的是为了明确项目开发的的具体需求与对应任务，协调并指导分工与合作。

## 1.2 对象

本文档的预期读者是：
• 需求提起者，亦即项目开发全体人员：软件工程9组的全体成员
• 指导助教、老师

## 1.3 德州扑克规则简述

### **基本规则**

德州扑克一共有52张扑克牌，没有王牌。每个牌局开始各玩家分别获得两张牌作为“底牌”，之后由荷官分三次共翻出五张“公共牌”，每次发牌是一个押注圈，在押注圈玩家可以进行看牌（让牌）、弃牌、下注、跟注、加注等动作。四轮下注完成后，还有两名或两名以上玩家，则进行比牌，牌型最大的玩家赢得该轮比赛。

### **a.第一轮（Preflop Round）**

**1**
发底牌前，庄家左侧的两位玩家分别下大、小盲注，荷官为各玩家发出两张底牌。**2**
发底牌后，由大盲注左侧的玩家开始依次押注行动。在没有人加注的情况下，大盲注位置的玩家行动结束后，本轮押注行动结束。若有人加注的情况下，直到最后加注玩家右则的第一个玩家行动结束后，本轮押注行动结束。

### **b.第二轮：翻牌圈（Flop Round）**

**1**
官发出3张公共牌到牌桌中央，称为“翻牌”，所有人可见。
**2**
发底牌后，由大盲注左侧的玩家开始依次押注行动。在没有人加注的情况下，大盲注位置的玩家行动结束后，本轮押注行动结束。若有人加注的情况下，直到最后加注玩家右则的第一个玩家行动结束后，本轮押注行动结束。

### **c.第三轮：转牌圈（Turn Round）**

**1**
荷官发出第4张公共牌到牌桌中央，称为“转牌”，所有人可见。
**2**
提醒：多了一张公共牌，各玩家的牌面可能发生转变，这时候各玩家需要重新判断牌局的形势

### **d.第四轮：河牌圈（River Round**）

**1**
荷官发出第5张公共牌到牌桌中央，称为“河牌”，所有人可见。
**2**
提醒：所有公共牌都发出了，这时候各玩家的牌面都固定下来，各玩家需再次判断形势作出合适的行动。

### **f.摊牌和比牌（Showdown）**

**1**
四轮下注都完成后，若还剩余两名或两名以上玩家，则进行比牌。比牌时，每位玩家用手中的两张底牌与五张公共牌中选出五张组成最大的牌型进行比较大小。如使用的五张全是公共牌，两张底牌不列入比较范围，各玩家只能平分底池。
**2**
比牌后，牌型最大的玩家赢得底池所有筹码；若多位玩家牌型相同，则平分底池。**PS**：中途若有玩家弃牌并只剩一名玩家，则牌局提前结束，奖池归剩下的该名玩家所有。
**3**
**比牌规则**:成手牌比牌时不分花色，从大到小比牌（如：都有一对的，对子大的胜出；对子相同，则比单张更大的胜出。以此类推）。若依次比牌完毕，双方大小相同，则均分底池内的注码。
**Top1 皇家同花顺 Royal Flush**：
5张牌同花色，且数字正好为A,K,Q,J,10。
**Top2 同花顺 Straight Flush**： 
5张牌同花色，且数字顺序相连。
**Top3 四条 Four of a Kind**：
5张牌当中的4张数字一样。
**Top4 葫芦 Full House**：
5张牌中，3张数字一样，另外2张数字一样。
**Top5 同花 Flush**：
5张牌的花色全部一样，数字无所谓。
**Top6 顺子 Straight**：
5张牌的数字顺序相连，花色无所谓。
**Top7 三条 Three of a Kind**：
5张牌中3张的数字一样，另外2张不同。
**Top8 两对 Two pairs**：
5张牌中，两两数字相同，余下一张不同。
**Top9 一对 Pair**：
5张牌中，2张牌的数字是一样的，另外3张各不相关。
**Top10 高牌 High card**：
5张牌毫无关系，没有全相连，也没全同花色，也没有一样的数字。



# 二、**需求概述**

## 2.1项目背景

**MiniFun**是一款用于在线联机娱乐的网页版应用，是为了快速便捷地进行线上桌游而开发的，现仅进行德州扑克的开发设计，由软件工程课程实践9组负责。

## 2.2需求概述

首先，由于进行游戏的人员需进行身份验证，设计注册与登录功能。成功登录后，需在初始页面选择游戏，然后创建房间或加入别人的房间。房间内，德州扑克游戏过程中需要进行下注、弃牌等活动，并设置观战席。



## **三、功能需求**

### **3.1功能总览**

|     功能     |                           具体描述                           |
| :----------: | :----------------------------------------------------------: |
|   **注册**   | 用户进入网站后选择注册，输入用户名与密码并完成相关资料填写后，成功创建账号。 |
|   **登录**   |   用户进入网站后选择登录，输入用户名与密码，验证后实现登录   |
| **选择游戏** |          实现登录后，可选择游戏，现阶段仅有德州扑克          |
| **创建房间** | 通过房间维护游戏进程；玩家选择游戏后可选择创建房间，并成为房主 |
| **加入房间** | 玩家在选择游戏后,还可以通过一个可加入房间列表(或输入房间号)，选择加入房间 |
| **开始游戏** |     由房主玩家执行的操作，需设置玩家准备状态、最小玩家数     |
| **德扑操作** | 房间自动安排座位、发牌，玩家下注、弃牌，需设置玩家每次操作时间上限 |
| **退出房间** |                准备阶段的玩家可以执行退出房间                |

## 3.2流程图

![image-20221008202214012](C:\Users\pc\AppData\Roaming\Typora\typora-user-images\image-20221008202214012.png)

## 3.3数据字典(暂定)

### (1)用户信息表

| 编号  |    字段名称     |     字段含义     |  字段类型  |      备注      |
| :---: | :-------------: | :--------------: | :--------: | :------------: |
| **1** |  **username**   |    **用户名**    | **string** |                |
| **2** |  **password**   |     **密码**     | **string** |                |
| **3** |   **room_id**   |    **房间号**    |  **int**   |                |
| **4** |   **seat_id**   |    **座位号**    |  **int**   |                |
| **5** |  **stack_cnt**  |   **持有筹码**   |  **int**   |                |
| **6** |  **chip_cnt**   | **本轮下注筹码** |  **int**   |                |
| **7** | **last_action** |  **上一个行为**  |  **int**   | **下注或弃牌** |
| **8** |    **pokes**    |     **手牌**     |  **list**  |                |

### (2)**房间信息表**

| **编号** |   **字段名称**   |   **字段含义**   | **字段类型** |   **备注**    |
| :------: | :--------------: | :--------------: | :----------: | :-----------: |
|  **1**   |   **room_id**    |    **房间号**    |   **int**    |               |
|  **2**   |  **game_type**   |   **游戏类型**   |   **int**    | **default:0** |
|  **3**   |   **user_num**   |   **玩家人数**   |   **int**    |               |
|  **4**   | **prepared_num** | **已准备玩家数** |   **int**    |               |

### （3）牌桌信息表

| 编号  |     字段名称     |     字段含义     | 字段类型 |     备注      |
| :---: | :--------------: | :--------------: | :------: | :-----------: |
| **1** |  **game_type**   |   **游戏类型**   | **int**  | **default:0** |
| **2** |     **chip**     |  **桌面总筹码**  | **int**  | **default:0** |
| **3** | **jokes_public** |    **公共牌**    | **list** |               |
| **4** |  **opseat_id**   | **正在操作用户** | **int**  |               |



# 四、软硬件需求

#### Chrome、Opera、Safari、Firefox及任何支持HTML5标准、JavaScript的浏览器。



# 五、可靠性与可用性需求

**1.可用性：用户的操作能在两秒内得到反馈**

**2.可靠性：对于用户失去连接的情况，支持重新连接和牌局暂停功能**

**3.可维护性：服务器重启、写进日志**

**4.安全性：对用户的密码加密**